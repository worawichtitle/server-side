{% extends "base.html" %}
{% load static %}

{% block title %}Condo list{% endblock %}

 {% block head %}
          <div class="flex items-center justify-between mb-8">
            <div>
                <h1 class="text-4xl font-bold bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent leading-loose">‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢</h1>
                <p class="text-gray-600 text-lg">
                ‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ <span class="font-bold text-blue-600">{{total}}</span> ‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î
                </p>
            </div>
          </div>

        <!-- Filter Section -->
        <section aria-label="Filter content" class="flex flex-row justify-between items-start gap-x-4 flex-wrap mb-8">
            <!-- Filter buttons -->
            <div class="flex flex-row gap-x-3" aria-label="Advanced Filters">
                <label for="deed_name">
                    <input type="radio" id="deed_name" name="a_filter" value="deed_name" class="peer hidden" {% if filter == 'deed_name' or filter == '' or filter == None %}checked{% endif %} />
                    <div class="cursor-pointer px-6 py-3 rounded-xl border-2 border-gray-200 bg-white bg-opacity-70 peer-checked:bg-gradient-to-r peer-checked:from-blue-500 peer-checked:to-purple-500 peer-checked:text-white peer-checked:border-transparent smooth-transition hover-lift shadow-md peer-checked:shadow-lg font-medium">
                        üìÖ ‡πÄ‡∏•‡∏Ç‡πÇ‡∏â‡∏ô‡∏î
                    </div>
                </label>
                <label for="name">
                    <input type="radio" id="name" name="a_filter" value="name" class="peer hidden" {% if filter == 'name' %}checked{% endif %} />
                    <div class="cursor-pointer px-6 py-3 rounded-xl border-2 border-gray-200 bg-white bg-opacity-70 peer-checked:bg-gradient-to-r peer-checked:from-green-500 peer-checked:to-emerald-500 peer-checked:text-white peer-checked:border-transparent smooth-transition hover-lift shadow-md peer-checked:shadow-lg font-medium">
                        üè¢ ‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î
                    </div>
                </label>
                <label for="status">
                    <input type="radio" id="status" name="a_filter" value="status" class="peer hidden" {% if filter == 'status' %}checked{% endif %} />
                    <div class="cursor-pointer px-6 py-3 rounded-xl border-2 border-gray-200 bg-white bg-opacity-70 peer-checked:bg-gradient-to-r peer-checked:from-orange-500 peer-checked:to-red-500 peer-checked:text-white peer-checked:border-transparent smooth-transition hover-lift shadow-md peer-checked:shadow-lg font-medium">
                        üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
                    </div>
                </label>
                {% if request.session.staff_id %}
                <label for="user">
                    <input type="radio" id="user" name="a_filter" value="user" class="peer hidden" {% if filter == 'user' %}checked{% endif %} />
                    <div class="cursor-pointer px-6 py-3 rounded-xl border-2 border-gray-200 bg-white bg-opacity-70 peer-checked:bg-gradient-to-r peer-checked:from-orange-500 peer-checked:to-red-500 peer-checked:text-white peer-checked:border-transparent smooth-transition hover-lift shadow-md peer-checked:shadow-lg font-medium">
                        üë§ ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢
                    </div>
                </label>
                {% endif %}
            </div>

           <!-- Search + Clear -->
          <div class="flex flex-row items-center gap-x-3">
              <input 
                  class="w-[350px] py-3 px-4 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent smooth-transition bg-white bg-opacity-70 shadow-md" 
                  id="search" 
                  type="text" 
                  placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î..." 
                  autocomplete="search" 
                  value="{{search}}" 
                  title="Filter data" 
              />
              <a href="{% url 'condo-list' %}">
                  <div class="cursor-pointer px-6 py-3 rounded-xl border-2 border-transparent bg-gradient-to-r from-red-500 to-pink-500 text-white hover:from-red-600 hover:to-pink-600 smooth-transition hover-lift shadow-lg font-medium flex items-center space-x-2">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                      </svg>
                      <span>‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</span>
                  </div>
              </a>
          </div>

        </section>
{% endblock %}


{% block content %} 
<div class="container mx-auto p-4">
    <div class="flex justify-between items-center mb-6">
        <h1 class="text-3xl font-bold">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h1>
        {% if request.session.user_id %}
        <a href="{% url 'condo-create' %}" 
           class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-300">
            + ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î
        </a>
        {% endif %}
    </div>
    
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for listing in condo_list %}
        {% if request.session.user_id %}
        <a href="{% url 'condo-detail' listing.condo.deed_number %}"
                class="block bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100 hover:shadow-xl hover:border-blue-400 transition duration-300 ease-in-out">
        {% else %}
        <a href="{% url 'staff-cdetail' listing.condo.deed_number %}"
                class="block bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100 hover:shadow-xl hover:border-blue-400 transition duration-300 ease-in-out">
        {% endif %}
            <div class="bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100">

                {% with condo=listing.condo %}
                    
                    {% with first_image=condo.images.first %}
                        <div class="h-48 bg-gray-200 overflow-hidden">
                            {% if first_image %}
                                <img src="{{ first_image.image_url.url }}" alt="{{ condo.name }}" 
                                     class="w-full h-full object-cover">
                            {% else %}
                                <div class="w-full h-full flex items-center justify-center text-gray-500">
                                    ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
                                </div>
                            {% endif %}
                        </div>
                    {% endwith %}
                    
                    <div class="p-4">
                        
                        <h2 class="text-xl font-semibold mb-2 truncate-name" title="{{ condo.name }}">
                            {{ condo.name }}
                        </h2>
                        
                        <div class="flex justify-between items-center text-sm mb-3">
                            <span class="text-gray-600">
                                <i class="fas fa-map-marker-alt mr-1"></i> 
                                ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î: {{ condo.province.name }}
                            </span>
                            
                            <span class="font-medium px-2 py-0.5 rounded-full 
                                {% if condo.status == 'PAS' %}bg-green-100 text-green-700
                                {% elif condo.status == 'FAL' or condo.status == 'CAL' %}bg-red-100 text-red-700
                                {% elif condo.status == 'BUY' %}bg-blue-100 text-blue-700
                                {% elif condo.status == 'CHK' %}bg-yellow-100 text-yellow-700
                                {% else %}bg-gray-200 text-gray-700{% endif %}">
                                {{ condo.get_status_display }}
                            </span>
                        </div>
                        
                        <p class="text-gray-500 text-sm line-clamp-2 mb-3">
                            {{ condo.description|default:"‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î‡∏ô‡∏µ‡πâ" }}
                        </p>
                        <div class="flex justify-between items-center text-sm mb-3">
                            <span class="text-gray-600">
                                <i class="fas fa-map-marker-alt mr-1"></i> 
                                ‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢: {{ listing.user.first_name }} {{ listing.user.last_name }}
                            </span>
                            
                            <span class="text-gray-600">
                                <i class="fas fa-map-marker-alt mr-1"></i> 
                                ‡∏£‡∏≤‡∏Ñ‡∏≤: {{ listing.asking_price }}‡∏ø
                            </span>
                        </div>
                    </div>
                {% endwith %}
                
            </div>
        </a>
        {% empty %}
            <div class="col-span-full flex justify-center py-10">
                <p class="text-xl text-gray-500 font-medium">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏™‡∏ô‡∏≠‡∏Ç‡∏≤‡∏¢‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î</p>
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}


    
    
{% block script %}
      <script src="{% static 'search.js' %}"></script>
{% endblock %}